{
  // 迭代蓝图模板
  // 详细描述实现步骤、文件创建、代码结构和技术细节
  // 注意：此模板提供结构框架，可根据实际需求扩展或省略部分字段
  // 所有字段都有注释说明，必填字段会明确标注
  // 
  // 重要说明：
  // - files 部分按功能模块分类（如 dataAdapters, repositories, services 等），而不是按文件类型
  // - 每个文件的 details 数组应详细列出所有实现细节和方法
  // - tasks 中的 action 可以是字符串或数组（数组用于复杂流程，如修复流程）
  // - implementationSteps 前应说明错误处理策略和自动执行规则
  
  // ===========================================
  // 1. 迭代概述（必填）
  // ===========================================
  iteration: {
    // 迭代 ID：格式建议 YYMMDD-<module>-<slug>
    // 示例："251105-pomodoro-timer-page"
    id: "YYMMDD-module-slug",
    
    // 迭代标题
    title: "迭代标题",
    
    // 迭代描述：简要说明本次迭代要实现的功能
    description: "基于设计文档实现XX功能，包含XX、XX等功能",
    
    // 状态：planning, in_progress, completed, cancelled
    status: "planning",
    
    // 优先级：high, medium, low
    priority: "high",
    
    // 基于的设计文档路径（可选）
    basedOnDesign: "documents/json5/<module>/design.json5",
  },

  // ===========================================
  // 2. 文件创建清单（必填）
  // ===========================================
  // 按功能模块组织文件，方便管理和查看
  // 注意：分类名称应根据实际项目调整（如 dataAdapters, repositories, services, widgets, pages 等）
  files: {
    // 示例：数据库适配器层
    dataAdapters: [
      {
        // 文件路径
        path: "lib/data/database/xxx_adapter.dart",
        // 文件用途说明
        purpose: "文件用途描述",
        // 操作类型：create（新建）、modify（修改）
        action: "create", // 或 "modify"
        // 预估代码行数
        estimatedLines: 100,
        // 依赖的其他文件（可选）
        dependencies: [
          "依赖文件1",
          "依赖文件2",
        ],
        // 详细实现说明（必填，数组格式，列出所有实现细节）
        details: [
          "实现方法1：详细说明方法的功能和实现方式",
          "实现方法2：详细说明方法的功能和实现方式",
          "错误处理：说明错误处理策略",
          "性能优化：说明性能优化措施",
        ],
      },
      // 可以添加更多文件
    ],
    
    // 示例：数据模型层
    models: [
      {
        path: "lib/data/models/xxx.dart",
        purpose: "数据模型说明",
        action: "create",
        estimatedLines: 100,
        dependencies: [],
        details: [
          "字段1：类型和说明",
          "字段2：类型和说明",
          "方法1：功能说明",
        ],
      },
    ],
    
    // 示例：Repository 层
    repositories: [
      {
        path: "lib/data/repositories/xxx_repository.dart",
        purpose: "Repository 说明",
        action: "create",
        estimatedLines: 200,
        dependencies: [],
        details: [
          "实现 Repository 接口的所有方法：method1、method2、method3",
          "method1 方法：详细说明实现逻辑",
          "method2 方法：详细说明实现逻辑",
          "关系查询策略：说明如何处理关联查询",
          "性能优化：说明查询优化措施",
        ],
      },
    ],
    
    // 示例：服务层
    services: [
      {
        path: "lib/core/services/xxx_service.dart",
        purpose: "服务层说明",
        action: "create",
        estimatedLines: 150,
        dependencies: [],
        details: [
          "服务功能说明",
          "方法实现细节",
        ],
      },
    ],
    
    // 示例：Provider 状态管理
    providers: [
      {
        path: "lib/core/providers/xxx_providers.dart",
        purpose: "状态管理说明",
        action: "create",
        estimatedLines: 200,
        dependencies: [],
        details: [
          "Provider 功能说明",
          "状态管理逻辑",
        ],
      },
    ],
    
    // 示例：Widget 组件
    widgets: [
      {
        path: "lib/presentation/xxx/widgets/xxx.dart",
        purpose: "组件说明",
        action: "create",
        estimatedLines: 150,
        dependencies: [],
        details: [
          "组件功能说明",
          "属性说明",
          "交互逻辑",
        ],
      },
    ],
    
    // 示例：页面文件
    pages: [
      {
        path: "lib/presentation/xxx/pages/xxx_page.dart",
        purpose: "页面说明",
        action: "create",
        estimatedLines: 300,
        dependencies: [],
        details: [
          "页面功能说明",
          "布局结构",
          "状态管理",
        ],
      },
    ],
    
    // 示例：测试文件
    tests: [
      {
        path: "test/xxx/xxx_test.dart",
        purpose: "测试说明",
        action: "create",
        estimatedLines: 100,
        dependencies: [],
        details: [
          "测试覆盖范围",
          "测试用例说明",
        ],
      },
    ],
    
    // 可以根据需要添加更多类别
    // 例如：migrations（数据库迁移）、converters（类型转换器）等
  },

  // ===========================================
  // 3. 需要修改的现有文件（可选）
  // ===========================================
  modifications: [
    {
      // 文件路径
      file: "lib/xxx/xxx.dart",
      // 修改目的
      purpose: "修改目的说明",
      // 具体修改内容列表
      changes: [
        "修改点1：详细说明",
        "修改点2：详细说明",
      ],
      // 预估代码行数
      estimatedLines: 20,
    },
    // 可以添加更多修改项
  ],

  // ===========================================
  // 4. 实现步骤（必填）
  // ===========================================
  // 注意：阶段完成后自动执行下一阶段，不需要沟通确认
  // AI 开发将完成所有功能，按顺序执行所有阶段
  // 每个阶段完成时忽略 pre-commit，强行 git commit（使用 --no-verify 选项）
  // 
  // 错误处理策略：
  // - 如果某个任务失败，先尝试修复（如 analyze issues、测试失败），修复后继续
  // - 如果无法自动修复（如需要人工决策），记录问题并继续下一个任务，在阶段完成时总结所有未解决问题
  // - build_runner 冲突：使用 --delete-conflicting-outputs 参数自动删除冲突文件
  // - analyze issues 无法自动修复：记录到 commit message 中，标记为已知问题，继续后续任务
  implementationSteps: [
    {
      // 步骤序号
      step: 1,
      // 步骤标题
      title: "阶段 1：步骤标题",
      // 步骤描述
      description: "步骤详细描述",
      // 任务列表
      tasks: [
        {
          // 任务描述
          task: "任务描述",
          // 相关文件（可选）
          file: "lib/xxx/xxx.dart",
          // 具体操作（可选，可以是字符串或数组）
          // 字符串格式：简单操作说明
          action: "具体操作说明",
          // 数组格式：复杂流程，每个步骤一行
          // action: [
          //   "步骤 1：操作说明",
          //   "步骤 2：操作说明",
          //   "步骤 3：操作说明",
          // ],
        },
        // 如果是命令执行任务
        {
          task: "运行命令",
          command: "flutter pub get",
          // command 任务也可以有 action 说明
          action: "命令执行说明",
        },
        // 阶段完成时的 git commit 任务
        {
          task: "阶段完成：忽略 pre-commit，强行 git commit",
          command: "git add -A && git commit --no-verify -m 'feat: 阶段 1 完成 - 步骤标题'",
          action: "提交阶段 1 的所有更改，忽略 pre-commit 钩子",
        },
        // 可以添加更多任务
      ],
    },
    // 可以添加更多步骤
  ],

  // ===========================================
  // 5. 技术细节和注意事项（必填）
  // ===========================================
  technicalDetails: {
    // 关键技术决策
    keyDecisions: {
      // 示例：库选择
      libraryChoice: {
        recommendation: "推荐使用的库",
        reason: "选择理由",
        alternative: "备选方案",
      },
      // 示例：实现方案
      implementation: {
        method: "实现方法",
        stateManagement: "状态管理方案",
        rollback: "回滚策略（如适用）",
      },
    },
    
    // 代码规范要求
    codeStandards: {
      // 示例：接口规范
      interfaceRule: {
        rule: "规则描述",
        location: "文件路径或位置",
        example: "正确示例",
        note: "注意事项",
      },
      // 示例：类型安全
      typeSafety: {
        rule: "类型安全要求",
        location: "相关文件",
        example: "正确用法示例",
        note: "注意事项",
      },
    },
    
    // 性能考虑（可选）
    performance: {
      // 优化措施
      optimization: [
        "优化措施1",
        "优化措施2",
      ],
      // 性能监控
      monitoring: [
        "监控项1",
        "监控项2",
      ],
    },
    
    // 安全考虑（可选）
    security: {
      concerns: [
        "安全考虑1",
        "安全考虑2",
      ],
    },
  },

  // ===========================================
  // 6. 依赖关系图（可选）
  // ===========================================
  dependencies: {
    // 数据层依赖
    dataLayer: [
      "数据层文件1",
      "数据层文件2",
    ],
    
    // Repository 层依赖
    repositoryLayer: [
      "Repository 层文件1",
      "Repository 层文件2",
    ],
    
    // 服务层依赖
    serviceLayer: [
      "服务层文件1",
      "服务层文件2",
    ],
    
    // Provider 层依赖
    providerLayer: [
      "Provider 层文件1",
      "Provider 层文件2",
    ],
    
    // UI 组件层依赖
    uiLayer: [
      "UI 层文件1",
      "UI 层文件2",
    ],
    
    // 配置层依赖（可选）
    configLayer: [
      "配置层文件1",
      "配置层文件2",
    ],
    
    // 可以根据需要添加更多层级
  },

  // ===========================================
  // 7. 测试策略和详细测试用例（必填）
  // ===========================================
  testing: {
    // 单元测试
    unitTests: [
      {
        // 测试文件路径
        file: "test/xxx/xxx_test.dart",
        // 测试描述
        description: "测试什么功能",
        // 测试用例列表
        testCases: [
          {
            // 测试组名称
            group: "测试组名称",
            // 具体测试用例
            cases: [
              {
                // 测试用例名称
                name: "测试用例名称",
                // 测试步骤描述
                test: "测试步骤：操作1 → 操作2 → 验证结果",
              },
              // 可以添加更多测试用例
            ],
          },
          // 可以添加更多测试组
        ],
      },
      // 可以添加更多单元测试文件
    ],
    
    // Widget 测试
    widgetTests: [
      {
        file: "test/presentation/xxx/xxx_test.dart",
        description: "Widget 测试说明",
        testCases: [
          {
            group: "测试组名称",
            cases: [
              {
                name: "测试用例名称",
                test: "测试步骤描述",
              },
            ],
          },
        ],
      },
    ],
    
    // 集成测试
    integrationTests: [
      {
        file: "integration_test/xxx_test.dart",
        description: "集成测试说明",
        testCases: [
          {
            group: "测试组名称",
            cases: [
              {
                name: "测试用例名称",
                test: "测试步骤描述",
              },
            ],
          },
        ],
      },
    ],
  },

  // ===========================================
  // 8. 风险点和注意事项（必填）
  // ===========================================
  risks: [
    {
      // 风险描述
      risk: "风险描述",
      // 缓解措施
      mitigation: "如何缓解或避免风险",
      // 优先级：high, medium, low
      priority: "high",
      // 检查项（可选）
      check: "如何检查风险是否发生",
      // 强制执行措施（可选）
      enforcement: "如何强制执行缓解措施",
    },
    // 可以添加更多风险点
  ],

  // ===========================================
  // 9. 验证清单（必填）
  // ===========================================
  verification: {
    // 代码质量检查
    codeQuality: [
      "运行 flutter analyze，确保没有 lint 错误",
      "运行 flutter test，确保所有单元测试通过",
      "代码审查，确保符合代码规范",
    ],
    
    // 功能验证
    functionality: [
      "验证所有核心功能正常",
      "验证边界情况处理",
    ],
    
    // 性能验证（可选）
    performance: [
      "性能测试项1",
      "性能测试项2",
    ],
    
    // 兼容性验证（可选）
    compatibility: [
      "兼容性测试项1",
      "兼容性测试项2",
    ],
  },

  // ===========================================
  // 10. 数据与状态（可选，但建议包含）
  // ===========================================
  dataAndState: {
    // 数据模型变更
    modelChanges: [
      "数据模型变更1",
      "数据模型变更2",
    ],
    
    // 持久化结构变更
    persistenceChanges: [
      "持久化结构变更1",
      "持久化结构变更2",
    ],
    
    // 状态管理变更
    stateManagementChanges: [
      "状态管理变更1",
      "状态管理变更2",
    ],
  },
}
