meta:
  version: 1
  type: step
  iteration: "251027-tag-constants-refactor"
  generated_at: "2025-10-27 18:45:00"
  preview_file: "251027-tag-constants-refactor-preview.yaml"

summary:
  objective: "重构标签配置系统：迁移到 AppConstants，删除废弃代码，ARB 文件包含前缀"
  total_phases: 6
  estimated_time: "20分钟"

phases:
  - phase: 1
    name: "创建 AppConstants"
    status: "pending"
    tasks:
      - id: "1.1"
        description: "创建 lib/core/config/app_constants.dart"
        files:
          - "lib/core/config/app_constants.dart"
        status: "pending"
      
      - id: "1.2"
        description: "定义 TagDefinition 类"
        status: "pending"
      
      - id: "1.3"
        description: "定义 AppConstants.tags 列表（11个标签）"
        status: "pending"
  
  - phase: 2
    name: "更新 tag_repository.dart"
    status: "pending"
    tasks:
      - id: "2.1"
        description: "移除 TagConfigService 导入，添加 AppConstants 导入"
        files:
          - "lib/data/repositories/tag_repository.dart"
        status: "pending"
      
      - id: "2.2"
        description: "修改 initializeTags() 方法直接使用 AppConstants.tags"
        status: "pending"
  
  - phase: 3
    name: "删除 TagConfigService"
    status: "pending"
    tasks:
      - id: "3.1"
        description: "删除文件 lib/core/services/tag_config_service.dart"
        files:
          - "lib/core/services/tag_config_service.dart"
        status: "pending"
  
  - phase: 4
    name: "清理种子数据代码"
    status: "pending"
    tasks:
      - id: "4.1"
        description: "删除 SeedTag 类、SeedPayload.tags 字段"
        files:
          - "lib/data/repositories/seed_repository.dart"
        status: "pending"
      
      - id: "4.2"
        description: "移除 seed_import_service.dart 中对 payload.tags 的引用"
        files:
          - "lib/core/services/seed_import_service.dart"
        status: "pending"
  
  - phase: 5
    name: "更新 ARB 文件（添加前缀）"
    status: "pending"
    tasks:
      - id: "5.1"
        description: "更新所有 ARB 文件的标签翻译，添加 @ 或 # 前缀"
        files:
          - "lib/l10n/app_en.arb"
          - "lib/l10n/app_zh_CN.arb"
          - "lib/l10n/app_zh.arb"
          - "lib/l10n/app_zh_HK.arb"
        status: "pending"
      
      - id: "5.2"
        description: "运行 flutter gen-l10n 重新生成本地化文件"
        command: "flutter gen-l10n"
        status: "pending"
  
  - phase: 6
    name: "验证和测试"
    status: "pending"
    tasks:
      - id: "6.1"
        description: "运行 flutter analyze"
        command: "flutter analyze"
        status: "pending"
      
      - id: "6.2"
        description: "运行 flutter test"
        command: "flutter test"
        status: "pending"
      
      - id: "6.3"
        description: "手动验证标签显示"
        manual: true
        status: "pending"

execution_log:
  - timestamp: "2025-10-27 18:45:00"
    phase: 0
    message: "开始执行标签配置重构"

