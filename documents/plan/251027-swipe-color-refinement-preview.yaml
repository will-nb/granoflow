meta:
  version: 1
  type: preview
  iteration: "251027-swipe-color-refinement"
  generated_at: "2025-10-27 16:30:00"

summary:
  objective: "优化滑动操作的配色方案，使颜色语义更符合操作的推荐程度和危险级别"
  requirements: 
    - "需求1: 将Inbox右滑（快速规划到今日）的颜色从海盐蓝改为柔绿色，突出其「推荐操作」的语义"
    - "需求2: 保持Tasks右滑（归档）使用柔粉红色，表达其「警告操作」的语义"
    - "需求3: 将Tasks左滑（推迟）和右滑（归档）交换位置，符合主流UX规范（左滑危险，右滑安全）"
    - "需求4: 确保所有配色使用主题定义的颜色常量，而非硬编码"

# 配色语义设计
color_semantics:
  description: "基于操作推荐程度和危险级别的配色系统"
  
  color_hierarchy:
    - level: "最推荐（成功）"
      color: "softGreen (#7ED2A8)"
      semantic: "鼓励用户执行的操作"
      usage: "Inbox右滑（快速规划到今日）、Tasks左滑（推迟任务）"
      
    - level: "中性（信息）"
      color: "seaSaltBlue (#B5D9E7)"
      semantic: "普通操作，无特殊引导"
      usage: "保留用于未来需求"
      
    - level: "警告（需谨慎）"
      color: "softPink (#F48B8B)"
      semantic: "提醒用户谨慎执行的操作"
      usage: "Tasks右滑（归档任务）"
      
    - level: "危险（不可逆）"
      color: "errorDark (#690005)"
      semantic: "阻止用户误操作的严重警告"
      usage: "Inbox左滑（删除到回收站）"
  
  rationale:
    description: "配色调整的设计理念"
    principles:
      - principle: "操作推荐程度匹配颜色积极性"
        explanation: "快速规划是最值得推荐的操作（立即行动），使用绿色（成功/推荐）比蓝色（中性）更能传达积极引导"
      - principle: "危险级别匹配颜色警示性"
        explanation: "归档比推迟更需谨慎（任务会从主列表消失），粉红色（警告）比绿色更能传达风险提示"
      - principle: "主流UX一致性"
        explanation: "左滑放危险操作，右滑放安全操作，符合用户在其他应用中形成的肌肉记忆"
      - principle: "色彩无障碍考虑"
        explanation: "删除操作使用深红色（errorDark），即使对色盲用户也能通过深度感知危险性"

# 修改文件详细差异
modified_files:
  # 文件1: 滑动配置
  - file: "lib/presentation/widgets/swipe_configs.dart"
    type: "static_class"
    class_name: "SwipeConfigs"
    description: "更新Inbox和Tasks的滑动配置，调整颜色语义和操作顺序"
    
    current_structure:
      - "Inbox: 左滑删除(errorDark) + 右滑快速规划(seaSaltBlue)"
      - "Tasks: 左滑归档(softPink) + 右滑推迟(softGreen)"
    
    new_structure:
      - "Inbox: 左滑删除(errorDark) + 右滑快速规划(softGreen) ✅"
      - "Tasks: 左滑推迟(softGreen) + 右滑归档(softPink) ✅"
    
    implementation_changes:
      - field: "inboxConfig.rightColor"
        current: "OceanBreezeColorSchemes.seaSaltBlue  // 海盐蓝 (中性)"
        new: "OceanBreezeColorSchemes.softGreen        // 柔绿色 (推荐)"
        reason: "强调快速规划是最推荐的操作，使用绿色（成功语义）引导用户"
        
      - field: "inboxConfig 注释"
        current: "左滑：删除到回收站（危险操作），右滑：快速规划到今日（安全操作）"
        new: "左滑：删除到回收站（危险操作），右滑：快速规划到今日（推荐操作）"
        reason: "明确语义：从「安全」提升为「推荐」"
        
      - field: "tasksConfig.leftAction"
        current: "SwipeActionType.archive  // 归档"
        new: "SwipeActionType.postpone    // 推迟"
        reason: "交换位置：左滑放更危险的归档改为更安全的推迟"
        
      - field: "tasksConfig.rightAction"
        current: "SwipeActionType.postpone  // 推迟"
        new: "SwipeActionType.archive      // 归档"
        reason: "交换位置：右滑放更安全的推迟改为需警惕的归档"
        
      - field: "tasksConfig.leftHintKey"
        current: "taskArchiveAction"
        new: "taskPostponeAction"
        reason: "匹配leftAction的变化"
        
      - field: "tasksConfig.rightHintKey"
        current: "taskPostponeAction"
        new: "taskArchiveAction"
        reason: "匹配rightAction的变化"
        
      - field: "tasksConfig.leftIcon"
        current: "Icons.archive"
        new: "Icons.schedule"
        reason: "匹配leftAction的变化（推迟用schedule图标）"
        
      - field: "tasksConfig.rightIcon"
        current: "Icons.schedule"
        new: "Icons.archive"
        reason: "匹配rightAction的变化（归档用archive图标）"
        
      - field: "tasksConfig.leftColor"
        current: "OceanBreezeColorSchemes.softPink   // 柔粉红（警告）"
        new: "OceanBreezeColorSchemes.softGreen     // 柔绿色（推荐）"
        reason: "推迟是安全操作，使用绿色表达推荐语义"
        
      - field: "tasksConfig.rightColor"
        current: "OceanBreezeColorSchemes.softGreen  // 柔绿色（推荐）"
        new: "OceanBreezeColorSchemes.softPink      // 柔粉红（警告）"
        reason: "归档需谨慎，保持粉红色表达警告语义"
        
      - field: "tasksConfig 注释"
        current: "左滑：归档任务（相对安全操作），右滑：智能推迟（相对安全操作）"
        new: "左滑：智能推迟（安全操作），右滑：归档任务（警告操作）"
        reason: "明确语义层次：推迟（安全）vs 归档（警告）"
    
    calls:
      - "lib/presentation/inbox/inbox_page.dart (inboxConfig)"
      - "lib/presentation/tasks/task_list_page.dart (tasksConfig)"

  # 文件2: Tasks页面
  - file: "lib/presentation/tasks/task_list_page.dart"
    type: "ConsumerStatefulWidget"
    class_name: "TaskTile"
    description: "更新DismissibleTaskTile的回调函数，交换左滑/右滑的动作处理"
    
    current_structure:
      - "onLeftAction: 归档 (SwipeActionType.archive)"
      - "onRightAction: 推迟 (SwipeActionType.postpone)"
    
    new_structure:
      - "onLeftAction: 推迟 (SwipeActionType.postpone) ✅"
      - "onRightAction: 归档 (SwipeActionType.archive) ✅"
    
    implementation_changes:
      - field: "DismissibleTaskTile.onLeftAction"
        current: |
          onLeftAction: (task) => SwipeActionHandler.handleAction(
            context, ref, SwipeActionType.archive, task
          ),
        new: |
          onLeftAction: (task) => SwipeActionHandler.handleAction(
            context, ref, SwipeActionType.postpone, task
          ),
        reason: "配合SwipeConfigs.tasksConfig的变化，左滑执行推迟操作"
        
      - field: "DismissibleTaskTile.onRightAction"
        current: |
          onRightAction: (task) => SwipeActionHandler.handleAction(
            context, ref, SwipeActionType.postpone, task
          ),
        new: |
          onRightAction: (task) => SwipeActionHandler.handleAction(
            context, ref, SwipeActionType.archive, task
          ),
        reason: "配合SwipeConfigs.tasksConfig的变化，右滑执行归档操作"
    
    dependencies:
      - "lib/presentation/widgets/dismissible_task_tile.dart"
      - "lib/presentation/widgets/swipe_action_handler.dart"
      - "lib/presentation/widgets/swipe_configs.dart"

# 视觉变化总结
visual_changes:
  inbox_page:
    description: "Inbox页面的视觉变化"
    changes:
      - element: "右滑背景色"
        before: "海盐蓝 (#B5D9E7 / 中性蓝色)"
        after: "柔绿色 (#7ED2A8 / 推荐绿色)"
        impact: "用户在右滑时会看到绿色背景，传达「这是推荐操作」的积极引导"
      - element: "左滑背景色"
        before: "深红色 (#690005)"
        after: "深红色 (#690005)"
        impact: "无变化，保持危险操作的强警示"
  
  tasks_page:
    description: "Tasks页面的视觉变化"
    changes:
      - element: "左滑操作"
        before: "归档（粉红色背景 + archive图标）"
        after: "推迟（绿色背景 + schedule图标）"
        impact: "用户在左滑时会看到绿色背景和时钟图标，传达「这是安全操作」"
      - element: "右滑操作"
        before: "推迟（绿色背景 + schedule图标）"
        after: "归档（粉红色背景 + archive图标）"
        impact: "用户在右滑时会看到粉红色背景和归档图标，传达「需谨慎操作」"
      - element: "滑动提示文字"
        before: "提示: 向右滑动可以归档, 向左滑动可以推迟。"
        after: "提示: 向右滑动可以推迟, 向左滑动可以归档。"
        impact: "提示文字会自动根据SwipeConfigs动态构建，与实际操作保持一致"

# 用户体验改进
ux_improvements:
  - aspect: "操作引导性"
    improvement: "快速规划使用绿色（推荐），比蓝色（中性）更能激励用户立即处理Inbox任务"
    benefit: "提高用户的任务规划效率和Inbox清空率"
    
  - aspect: "操作安全性"
    improvement: "Tasks左滑改为推迟（安全），右滑改为归档（警告），符合左危险右安全的主流UX"
    benefit: "减少用户误操作风险，降低学习成本"
    
  - aspect: "色彩语义一致性"
    improvement: "建立统一的配色语义层次：绿色（推荐）> 蓝色（中性）> 粉红（警告）> 深红（危险）"
    benefit: "用户可以通过颜色直观判断操作的推荐程度和危险级别"
    
  - aspect: "无障碍友好"
    improvement: "删除操作使用深红色（#690005），具有足够的深度对比，色盲用户也能感知危险"
    benefit: "提升色盲用户的使用体验，符合WCAG无障碍标准"

# 配色对比表
color_comparison_table:
  description: "修改前后的配色对比"
  
  inbox:
    left_swipe:
      action: "删除到回收站"
      color_before: "errorDark (#690005)"
      color_after: "errorDark (#690005)"
      semantic: "危险操作"
      change: "无变化 ✓"
    right_swipe:
      action: "快速规划到今日"
      color_before: "seaSaltBlue (#B5D9E7)"
      color_after: "softGreen (#7ED2A8)"
      semantic: "推荐操作"
      change: "中性蓝 → 推荐绿 ✅"
  
  tasks:
    left_swipe:
      action_before: "归档任务"
      action_after: "智能推迟"
      color_before: "softPink (#F48B8B)"
      color_after: "softGreen (#7ED2A8)"
      semantic_before: "警告操作"
      semantic_after: "安全操作"
      change: "警告粉 → 推荐绿 ✅"
    right_swipe:
      action_before: "智能推迟"
      action_after: "归档任务"
      color_before: "softGreen (#7ED2A8)"
      color_after: "softPink (#F48B8B)"
      semantic_before: "安全操作"
      semantic_after: "警告操作"
      change: "推荐绿 → 警告粉 ✅"

# 测试策略
testing_strategy:
  unit_tests:
    description: "无需新增单元测试，现有测试已覆盖SwipeActionHandler的所有操作逻辑"
    coverage_target: "保持 ≥80%"
    test_files:
      - "test/presentation/widgets/swipe_action_handler_test.dart (已存在)"
  
  widget_tests:
    description: "无需新增组件测试，DismissibleTaskTile的测试已覆盖配置参数化"
    test_files:
      - "test/presentation/widgets/dismissible_task_tile_test.dart (如已存在)"
  
  manual_tests:
    description: "手动验证视觉和交互变化"
    test_cases:
      - case: "Inbox右滑颜色验证"
        steps:
          - "打开Inbox页面"
          - "展开任一任务"
          - "向右滑动任务"
        expected: "背景色为柔绿色 (#7ED2A8)，图标为today，提示文字为「快速规划」"
        
      - case: "Tasks左滑操作验证"
        steps:
          - "打开Tasks页面"
          - "展开任一任务"
          - "向左滑动任务"
        expected: "背景色为柔绿色 (#7ED2A8)，图标为schedule，提示文字为「推迟」，执行后任务due date被智能推迟"
        
      - case: "Tasks右滑操作验证"
        steps:
          - "打开Tasks页面"
          - "展开任一任务"
          - "向右滑动任务"
        expected: "背景色为柔粉红 (#F48B8B)，图标为archive，提示文字为「归档」，执行后任务被归档"
        
      - case: "滑动提示文字一致性"
        steps:
          - "分别展开Inbox和Tasks页面的任务"
          - "阅读滑动提示文字"
        expected: "提示文字动态构建，准确反映当前页面的左滑/右滑操作"

# 成功标准
success_criteria:
  - "所有现有测试通过（单元测试、组件测试）"
  - "代码覆盖率保持 ≥80%"
  - "手动测试验证视觉变化符合预期"
  - "通过 flutter analyze 检查"
  - "滑动操作的颜色、图标、文字三者语义一致"
  - "配色符合WCAG无障碍标准（对比度、色盲友好）"
  - "符合主流UX规范（左滑危险，右滑安全）"

# 影响范围
impact_scope:
  files_modified: 2
  files_added: 0
  files_removed: 0
  
  affected_features:
    - "Inbox页面的滑动操作视觉表现"
    - "Tasks页面的滑动操作顺序和视觉表现"
  
  non_affected_features:
    - "滑动操作的功能逻辑（无变化）"
    - "SnackBar反馈文案（无变化）"
    - "展开面板的其他功能（标签、日期选择等）"
    - "智能推迟的计算逻辑（无变化）"

# 注意事项
notes:
  - note: "颜色常量确认"
    description: "所有使用的颜色（softGreen, softPink, errorDark）均在 OceanBreezeColorSchemes 中定义，无硬编码"
    
  - note: "本地化文案"
    description: "滑动提示文字通过 swipeHintTemplate 动态构建，会自动使用正确的本地化字符串"
    
  - note: "用户习惯迁移"
    description: "Tasks页面的左右滑操作对调，需要在发版说明中提示用户（如有必要）"
    
  - note: "色盲友好"
    description: "除颜色外，还通过图标（schedule vs archive）和深度（浅vs深）区分操作，确保无障碍"

