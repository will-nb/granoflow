meta:
  version: 1
  type: step
  iteration: "251027-swipe-color-refinement"
  generated_at: "2025-10-27 16:35:00"
  based_on_preview: "documents/plan/251027-swipe-color-refinement-preview.yaml"
  description: "基于preview文档的代码实现计划：优化滑动操作配色和顺序"

# 执行状态跟踪
execution_status:
  overall_status: "pending"
  current_phase: "analysis"
  completed_phases: []
  
  phases:
    - name: "analysis"
      description: "需求分析和实现规划"
      status: "completed"
      tasks:
        - task: "分析preview文档需求"
          status: "completed"
          retry_count: 0
          failure_reasons: []
        - task: "确定实现文件列表"
          status: "completed"
          retry_count: 0
          failure_reasons: []
        - task: "分析依赖关系"
          status: "completed"
          retry_count: 0
          failure_reasons: []
    
    - name: "implementation"
      description: "代码实现"
      status: "pending"
      tasks:
        - task: "修改swipe_configs.dart"
          status: "pending"
          retry_count: 0
          failure_reasons: []
        - task: "修改task_list_page.dart"
          status: "pending"
          retry_count: 0
          failure_reasons: []
    
    - name: "verification"
      description: "代码验证"
      status: "pending"
      tasks:
        - task: "编译检查"
          status: "pending"
          retry_count: 0
          failure_reasons: []
        - task: "静态分析"
          status: "pending"
          retry_count: 0
          failure_reasons: []

# 实现计划
implementation_plan:
  description: "基于preview文档的代码实现计划"
  
  modified_files:
    description: "需要修改的现有文件"
    files:
      - file: "lib/presentation/widgets/swipe_configs.dart"
        based_on: "preview.modified_files[0]"
        change_type: "modify"
        description: "更新Inbox和Tasks的滑动配置常量"
        changes:
          - type: "property_change"
            description: "修改inboxConfig.rightColor为softGreen"
            target: "inboxConfig"
            field: "rightColor"
            old_value: "OceanBreezeColorSchemes.seaSaltBlue"
            new_value: "OceanBreezeColorSchemes.softGreen"
          
          - type: "comment_update"
            description: "更新inboxConfig注释"
            target: "inboxConfig"
            old_comment: "左滑：删除到回收站（危险操作），右滑：快速规划到今日（安全操作）"
            new_comment: "左滑：删除到回收站（危险操作），右滑：快速规划到今日（推荐操作）"
          
          - type: "property_change"
            description: "交换tasksConfig的左右滑动作"
            target: "tasksConfig"
            changes_list:
              - field: "leftAction"
                old_value: "SwipeActionType.archive"
                new_value: "SwipeActionType.postpone"
              - field: "rightAction"
                old_value: "SwipeActionType.postpone"
                new_value: "SwipeActionType.archive"
              - field: "leftHintKey"
                old_value: "taskArchiveAction"
                new_value: "taskPostponeAction"
              - field: "rightHintKey"
                old_value: "taskPostponeAction"
                new_value: "taskArchiveAction"
              - field: "leftIcon"
                old_value: "Icons.archive"
                new_value: "Icons.schedule"
              - field: "rightIcon"
                old_value: "Icons.schedule"
                new_value: "Icons.archive"
              - field: "leftColor"
                old_value: "OceanBreezeColorSchemes.softPink"
                new_value: "OceanBreezeColorSchemes.softGreen"
              - field: "rightColor"
                old_value: "OceanBreezeColorSchemes.softGreen"
                new_value: "OceanBreezeColorSchemes.softPink"
          
          - type: "comment_update"
            description: "更新tasksConfig注释"
            target: "tasksConfig"
            old_comment: "左滑：归档任务（相对安全操作），右滑：智能推迟（相对安全操作）"
            new_comment: "左滑：智能推迟（安全操作），右滑：归档任务（警告操作）"
      
      - file: "lib/presentation/tasks/task_list_page.dart"
        based_on: "preview.modified_files[1]"
        change_type: "modify"
        description: "交换DismissibleTaskTile的左右滑回调函数"
        changes:
          - type: "method_modification"
            description: "交换onLeftAction和onRightAction"
            target: "DismissibleTaskTile实例化"
            changes_list:
              - field: "onLeftAction"
                old_value: "SwipeActionHandler.handleAction(context, ref, SwipeActionType.archive, task)"
                new_value: "SwipeActionHandler.handleAction(context, ref, SwipeActionType.postpone, task)"
              - field: "onRightAction"
                old_value: "SwipeActionHandler.handleAction(context, ref, SwipeActionType.postpone, task)"
                new_value: "SwipeActionHandler.handleAction(context, ref, SwipeActionType.archive, task)"

# 代码变更内容
code_changes:
  description: "具体的代码变更内容"
  
  modified_files:
    - file: "lib/presentation/widgets/swipe_configs.dart"
      action: "modify"
      based_on: "preview中modified_files[0]的变更设计"
      changes:
        - location: "inboxConfig常量"
          old_code: |
            /// Inbox页面的滑动配置
            /// 左滑：删除到回收站（危险操作），右滑：快速规划到今日（安全操作）
            static const SwipeActionConfig inboxConfig = SwipeActionConfig(
              leftAction: SwipeActionType.delete,
              rightAction: SwipeActionType.quickPlan,
              leftHintKey: 'inboxDeleteAction',
              rightHintKey: 'inboxQuickPlanAction',
              leftIcon: Icons.delete,
              rightIcon: Icons.today,
              leftColor: OceanBreezeColorSchemes.errorDark,
              rightColor: OceanBreezeColorSchemes.seaSaltBlue,
            );
          new_code: |
            /// Inbox页面的滑动配置
            /// 左滑：删除到回收站（危险操作），右滑：快速规划到今日（推荐操作）
            static const SwipeActionConfig inboxConfig = SwipeActionConfig(
              leftAction: SwipeActionType.delete,
              rightAction: SwipeActionType.quickPlan,
              leftHintKey: 'inboxDeleteAction',
              rightHintKey: 'inboxQuickPlanAction',
              leftIcon: Icons.delete,
              rightIcon: Icons.today,
              leftColor: OceanBreezeColorSchemes.errorDark,
              rightColor: OceanBreezeColorSchemes.softGreen,
            );
        
        - location: "tasksConfig常量"
          old_code: |
            /// Tasks页面的滑动配置
            /// 左滑：归档任务（相对安全操作），右滑：智能推迟（相对安全操作）
            static const SwipeActionConfig tasksConfig = SwipeActionConfig(
              leftAction: SwipeActionType.archive,
              rightAction: SwipeActionType.postpone,
              leftHintKey: 'taskArchiveAction',
              rightHintKey: 'taskPostponeAction',
              leftIcon: Icons.archive,
              rightIcon: Icons.schedule,
              leftColor: OceanBreezeColorSchemes.softPink,
              rightColor: OceanBreezeColorSchemes.softGreen,
            );
          new_code: |
            /// Tasks页面的滑动配置
            /// 左滑：智能推迟（安全操作），右滑：归档任务（警告操作）
            static const SwipeActionConfig tasksConfig = SwipeActionConfig(
              leftAction: SwipeActionType.postpone,
              rightAction: SwipeActionType.archive,
              leftHintKey: 'taskPostponeAction',
              rightHintKey: 'taskArchiveAction',
              leftIcon: Icons.schedule,
              rightIcon: Icons.archive,
              leftColor: OceanBreezeColorSchemes.softGreen,
              rightColor: OceanBreezeColorSchemes.softPink,
            );
    
    - file: "lib/presentation/tasks/task_list_page.dart"
      action: "modify"
      based_on: "preview中modified_files[1]的变更设计"
      changes:
        - location: "DismissibleTaskTile实例化（约第200行）"
          description: "交换onLeftAction和onRightAction的回调函数"
          old_code: |
            onLeftAction: (task) => SwipeActionHandler.handleAction(context, ref, SwipeActionType.archive, task),
            onRightAction: (task) => SwipeActionHandler.handleAction(context, ref, SwipeActionType.postpone, task),
          new_code: |
            onLeftAction: (task) => SwipeActionHandler.handleAction(context, ref, SwipeActionType.postpone, task),
            onRightAction: (task) => SwipeActionHandler.handleAction(context, ref, SwipeActionType.archive, task),

# 验证计划
verification_plan:
  description: "代码验证计划"
  
  compilation_check:
    description: "编译检查"
    steps:
      - step: "运行flutter analyze"
        command: "timeout 120 flutter analyze"
        expectation: "无错误和警告"
  
  basic_functionality:
    description: "基本功能验证"
    steps:
      - step: "验证swipe_configs.dart修改"
        method: "读取文件确认配置已更新"
        expectation: "inboxConfig.rightColor为softGreen, tasksConfig左右滑配置已交换"
      
      - step: "验证task_list_page.dart修改"
        method: "读取文件确认回调函数已交换"
        expectation: "onLeftAction调用postpone, onRightAction调用archive"
  
  manual_test_guide:
    description: "手动测试指南"
    test_cases:
      - case: "Inbox右滑颜色验证"
        steps:
          - "打开Inbox页面"
          - "展开任一任务"
          - "向右滑动任务"
        expected: "背景色为柔绿色 (#7ED2A8)"
      
      - case: "Tasks左滑操作验证"
        steps:
          - "打开Tasks页面"
          - "展开任一任务"
          - "向左滑动任务"
        expected: "背景色为柔绿色，图标为schedule，执行推迟操作"
      
      - case: "Tasks右滑操作验证"
        steps:
          - "打开Tasks页面"
          - "展开任一任务"
          - "向右滑动任务"
        expected: "背景色为柔粉红，图标为archive，执行归档操作"

# 成功标准
success_criteria:
  - "swipe_configs.dart中inboxConfig.rightColor已更改为softGreen"
  - "swipe_configs.dart中tasksConfig的左右滑配置已完全交换"
  - "task_list_page.dart中DismissibleTaskTile的回调函数已交换"
  - "代码通过flutter analyze检查，无错误和警告"
  - "配置变更符合preview文档设计"
  - "注释已更新，准确反映新的配置语义"

# 重试机制
retry_mechanism:
  max_retries: 3
  retry_conditions:
    - "编译错误"
    - "语法错误"
    - "文件修改失败"
  
  skip_records: []

# 执行记录
execution_log:
  - timestamp: "2025-10-27 16:35:00"
    action: "创建step计划文档"
    status: "completed"
    details: "基于preview文档创建详细的实施计划"

