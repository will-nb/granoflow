meta:
  name: "ServiceProviders"
  type: "provider"
  file_path: "lib/core/providers/service_providers.dart"
  description: "服务层 Provider 集合，管理业务逻辑层的依赖注入"
  version: "1.0"
  created_date: "251025"
  last_updated: "251025"

provider_definition:
  name: "ServiceProviders"
  layer: "dependency_injection"
  pattern: "provider"
  scope: "global"
  auto_dispose: false
  
provider_types:
  - name: "Provider"
    description: "基础 Provider，用于依赖注入"
    usage: "依赖注入、单例管理"
    
providers:
  - name: "metricOrchestratorProvider"
    type: "Provider"
    return_type: "MetricOrchestrator"
    dependencies:
      - name: "metricRepositoryProvider"
        type: "MetricRepository"
        description: "指标仓库依赖"
      - name: "taskRepositoryProvider"
        type: "TaskRepository"
        description: "任务仓库依赖"
      - name: "focusSessionRepositoryProvider"
        type: "FocusSessionRepository"
        description: "专注会话仓库依赖"
    description: "指标协调器 Provider"
    auto_dispose: false
    
  - name: "configOverridesProvider"
    type: "Provider"
    return_type: "AppConfig?"
    dependencies: []
    description: "配置覆盖 Provider"
    auto_dispose: false
    
  - name: "appConfigProvider"
    type: "Provider"
    return_type: "AppConfig"
    dependencies:
      - name: "configOverridesProvider"
        type: "AppConfig?"
        description: "配置覆盖依赖"
    description: "应用配置 Provider"
    auto_dispose: false
    
  - name: "taskServiceProvider"
    type: "Provider"
    return_type: "TaskService"
    dependencies:
      - name: "taskRepositoryProvider"
        type: "TaskRepository"
        description: "任务仓库依赖"
      - name: "tagRepositoryProvider"
        type: "TagRepository"
        description: "标签仓库依赖"
      - name: "metricOrchestratorProvider"
        type: "MetricOrchestrator"
        description: "指标协调器依赖"
    description: "任务服务 Provider"
    auto_dispose: false
    
  - name: "taskHierarchyServiceProvider"
    type: "Provider"
    return_type: "TaskHierarchyService"
    dependencies:
      - name: "taskRepositoryProvider"
        type: "TaskRepository"
        description: "任务仓库依赖"
      - name: "metricOrchestratorProvider"
        type: "MetricOrchestrator"
        description: "指标协调器依赖"
    description: "任务层次结构服务 Provider"
    auto_dispose: false
    
  - name: "focusFlowServiceProvider"
    type: "Provider"
    return_type: "FocusFlowService"
    dependencies:
      - name: "focusSessionRepositoryProvider"
        type: "FocusSessionRepository"
        description: "专注会话仓库依赖"
      - name: "taskRepositoryProvider"
        type: "TaskRepository"
        description: "任务仓库依赖"
      - name: "taskServiceProvider"
        type: "TaskService"
        description: "任务服务依赖"
      - name: "metricOrchestratorProvider"
        type: "MetricOrchestrator"
        description: "指标协调器依赖"
    description: "专注流程服务 Provider"
    auto_dispose: false
    
  - name: "preferenceServiceProvider"
    type: "Provider"
    return_type: "PreferenceService"
    dependencies:
      - name: "preferenceRepositoryProvider"
        type: "PreferenceRepository"
        description: "偏好设置仓库依赖"
    description: "偏好设置服务 Provider"
    auto_dispose: false
    
  - name: "taskTemplateServiceProvider"
    type: "Provider"
    return_type: "TaskTemplateService"
    dependencies:
      - name: "taskTemplateRepositoryProvider"
        type: "TaskTemplateRepository"
        description: "任务模板仓库依赖"
      - name: "taskRepositoryProvider"
        type: "TaskRepository"
        description: "任务仓库依赖"
      - name: "taskServiceProvider"
        type: "TaskService"
        description: "任务服务依赖"
    description: "任务模板服务 Provider"
    auto_dispose: false
    
  - name: "seedImportServiceProvider"
    type: "Provider"
    return_type: "SeedImportService"
    dependencies:
      - name: "seedRepositoryProvider"
        type: "SeedRepository"
        description: "种子数据仓库依赖"
      - name: "tagRepositoryProvider"
        type: "TagRepository"
        description: "标签仓库依赖"
      - name: "taskRepositoryProvider"
        type: "TaskRepository"
        description: "任务仓库依赖"
      - name: "taskTemplateRepositoryProvider"
        type: "TaskTemplateRepository"
        description: "任务模板仓库依赖"
      - name: "metricOrchestratorProvider"
        type: "MetricOrchestrator"
        description: "指标协调器依赖"
    description: "种子数据导入服务 Provider"
    auto_dispose: false
    
  - name: "monetizationServiceProvider"
    type: "Provider"
    return_type: "MonetizationService"
    dependencies:
      - name: "appConfigProvider"
        type: "AppConfig"
        description: "应用配置依赖"
    description: "货币化服务 Provider"
    auto_dispose: false
    
imports:
  - "package:flutter_riverpod/flutter_riverpod.dart"
  - "../config/app_config.dart"
  - "../services/focus_flow_service.dart"
  - "../services/metric_orchestrator.dart"
  - "../services/preference_service.dart"
  - "../services/seed_import_service.dart"
  - "../services/task_hierarchy_service.dart"
  - "../services/task_service.dart"
  - "../services/task_template_service.dart"
  - "../monetization/monetization_service.dart"
  - "repository_providers.dart"
  
dependencies:
  - name: "MetricOrchestrator"
    type: "core/services/metric_orchestrator.dart"
    description: "指标协调器依赖"
  - name: "TaskService"
    type: "core/services/task_service.dart"
    description: "任务服务依赖"
  - name: "TaskHierarchyService"
    type: "core/services/task_hierarchy_service.dart"
    description: "任务层次结构服务依赖"
  - name: "FocusFlowService"
    type: "core/services/focus_flow_service.dart"
    description: "专注流程服务依赖"
  - name: "PreferenceService"
    type: "core/services/preference_service.dart"
    description: "偏好设置服务依赖"
  - name: "TaskTemplateService"
    type: "core/services/task_template_service.dart"
    description: "任务模板服务依赖"
  - name: "SeedImportService"
    type: "core/services/seed_import_service.dart"
    description: "种子数据导入服务依赖"
  - name: "MonetizationService"
    type: "core/monetization/monetization_service.dart"
    description: "货币化服务依赖"
  - name: "AppConfig"
    type: "core/config/app_config.dart"
    description: "应用配置依赖"
  - name: "TaskRepository"
    type: "data/repositories/task_repository.dart"
    description: "任务仓库依赖"
  - name: "TagRepository"
    type: "data/repositories/tag_repository.dart"
    description: "标签仓库依赖"
  - name: "FocusSessionRepository"
    type: "data/repositories/focus_session_repository.dart"
    description: "专注会话仓库依赖"
  - name: "PreferenceRepository"
    type: "data/repositories/preference_repository.dart"
    description: "偏好设置仓库依赖"
  - name: "TaskTemplateRepository"
    type: "data/repositories/task_template_repository.dart"
    description: "任务模板仓库依赖"
  - name: "SeedRepository"
    type: "data/repositories/seed_repository.dart"
    description: "种子数据仓库依赖"
  - name: "MetricRepository"
    type: "data/repositories/metric_repository.dart"
    description: "指标仓库依赖"
    
responsibilities:
  - "业务逻辑层依赖注入"
  - "服务实例管理"
  - "服务协调"
  - "配置管理"
  - "服务生命周期管理"
  - "业务逻辑协调"
  
provider_categories:
  service_providers:
    - name: "metricOrchestratorProvider"
      description: "指标协调器 Provider"
      type: "Provider"
      return_type: "MetricOrchestrator"
    - name: "taskServiceProvider"
      description: "任务服务 Provider"
      type: "Provider"
      return_type: "TaskService"
    - name: "taskHierarchyServiceProvider"
      description: "任务层次结构服务 Provider"
      type: "Provider"
      return_type: "TaskHierarchyService"
    - name: "focusFlowServiceProvider"
      description: "专注流程服务 Provider"
      type: "Provider"
      return_type: "FocusFlowService"
    - name: "preferenceServiceProvider"
      description: "偏好设置服务 Provider"
      type: "Provider"
      return_type: "PreferenceService"
    - name: "taskTemplateServiceProvider"
      description: "任务模板服务 Provider"
      type: "Provider"
      return_type: "TaskTemplateService"
    - name: "seedImportServiceProvider"
      description: "种子数据导入服务 Provider"
      type: "Provider"
      return_type: "SeedImportService"
    - name: "monetizationServiceProvider"
      description: "货币化服务 Provider"
      type: "Provider"
      return_type: "MonetizationService"
      
  config_providers:
    - name: "configOverridesProvider"
      description: "配置覆盖 Provider"
      type: "Provider"
      return_type: "AppConfig?"
    - name: "appConfigProvider"
      description: "应用配置 Provider"
      type: "Provider"
      return_type: "AppConfig"
      
lifecycle_management:
  - phase: "initialization"
    description: "初始化阶段"
    operations: ["服务实例创建", "依赖注入", "配置加载"]
  - phase: "operation"
    description: "运行阶段"
    operations: ["业务逻辑处理", "服务协调", "状态管理"]
  - phase: "disposal"
    description: "清理阶段"
    operations: ["资源释放", "状态重置", "连接关闭"]
    
state_management:
  - pattern: "Provider"
    description: "依赖注入管理"
    implementation: "使用 Provider 管理服务依赖"
    benefits: "依赖注入、单例管理、生命周期管理"
    
error_handling:
  - exception: "ServiceException"
    description: "服务异常"
    handling: "记录日志并重新抛出"
    recovery: "重试机制"
  - exception: "DependencyException"
    description: "依赖异常"
    handling: "验证依赖并抛出描述性错误"
    recovery: "依赖重新注入"
  - exception: "ConfigException"
    description: "配置异常"
    handling: "验证配置并抛出描述性错误"
    recovery: "配置重新加载"
    
performance_considerations:
  - operation: "service_creation"
    optimization: "服务创建优化"
    description: "服务实例创建性能优化"
    caching: "服务实例缓存策略"
  - operation: "dependency_injection"
    optimization: "依赖注入优化"
    description: "依赖注入性能优化"
    caching: "依赖缓存策略"
  - operation: "service_coordination"
    optimization: "服务协调优化"
    description: "服务协调性能优化"
    caching: "协调结果缓存策略"
    
testing_strategy:
  unit_tests:
    - name: "test_provider_creation"
      description: "测试 Provider 创建"
    - name: "test_provider_dependencies"
      description: "测试 Provider 依赖"
    - name: "test_provider_state"
      description: "测试 Provider 状态"
    - name: "test_provider_lifecycle"
      description: "测试 Provider 生命周期"
    - name: "test_provider_disposal"
      description: "测试 Provider 清理"
    - name: "test_service_providers"
      description: "测试服务 Provider"
    - name: "test_config_providers"
      description: "测试配置 Provider"
      
  integration_tests:
    - name: "test_provider_integration"
      description: "测试 Provider 集成"
    - name: "test_provider_coordination"
      description: "测试 Provider 协调"
    - name: "test_service_coordination"
      description: "测试服务协调"
    - name: "test_config_management"
      description: "测试配置管理"
      
  mock_strategy:
    - name: "MockServiceProviders"
      description: "Mock 实现用于测试"
    - name: "FakeServiceProviders"
      description: "Fake 实现用于测试"
    - name: "TestServiceProviders"
      description: "测试专用 Provider"
      
provider_families:
  - name: "serviceProviderFamily"
    description: "服务 Provider 家族"
    parameters:
      - name: "serviceType"
        type: "String"
        description: "服务类型参数"
    usage: "参数化的服务 Provider"
    benefits: "支持多种服务类型"
    
provider_scopes:
  - name: "global"
    description: "全局作用域"
    usage: "应用级别的 Provider"
    lifecycle: "应用生命周期"
    
  - name: "local"
    description: "局部作用域"
    usage: "组件级别的 Provider"
    lifecycle: "组件生命周期"
    
  - name: "family"
    description: "家族作用域"
    usage: "参数化的 Provider"
    lifecycle: "参数生命周期"
