meta:
  summary: >
    Riverpod provider catalog for GranoFlow. Providers bridge UI widgets with
    services, expose reactive state, and funnel user intents back to the domain layer.
  conventions:
    naming: Use `xxxProvider` for simple providers, `xxxNotifier` + provider for state notifiers.
    error_policy: Emit `AsyncError` with domain exception, UI decides toast/snackbar handling.
    auto_dispose: Enable on view-scoped providers to avoid stale listeners.
  source_of_truth:
    - documents/architecture/services.yaml
    - documents/product_requirements.yaml
    - documents/user_stories.md

providers:
  - name: appLocaleProvider
    type: StreamProvider<Locale>
    scope: global
    depends_on: [PreferenceService]
    responsibility: Reflect current locale preference for MaterialApp.

  - name: themeProvider
    type: StreamProvider<ThemeMode>
    scope: global
    depends_on: [PreferenceService]
    responsibility: Sync theme preference with UI.

  - name: fontScaleProvider
    type: StreamProvider<double>
    scope: global
    depends_on: [PreferenceService]
    responsibility: Provide typography scale multiplier.

  - name: taskSectionsProvider
    type: StreamProvider.family<List<Task>, TaskSection>
    scope: home_screen
    depends_on: [TaskService]
    responsibility: Stream leaf tasks per section for base mode.

  - name: inboxTasksProvider
    type: StreamProvider<List<Task>>
    scope: inbox_screen
    depends_on: [TaskService, inboxFilterProvider]
    responsibility: Stream of inbox tasks按创建时间倒序输出，并根据上下文/优先级筛选。

  - name: inboxFilterProvider
    type: StateNotifierProvider<InboxFilterNotifier, InboxFilterState>
    scope: inbox_screen
    depends_on: []
    responsibility: 维护当前选中的 contextTag、priorityTag 以及搜索关键字，供列表与模板查询使用。

  - name: expandedRootTaskIdProvider
    type: StateProvider<int?>
    scope: task_list_edit_mode
    depends_on: []
    responsibility: Track which root task is currently expanded in edit mode.

  - name: rootTasksProvider
    type: StreamProvider<List<Task>>
    scope: task_list_edit_mode
    depends_on: [TaskService]
    responsibility: Provide list of root tasks (tasks without parentId) for edit mode.

  - name: taskTreeProvider
    type: StreamProvider.family<TaskTree, int>
    scope: task_list_edit_mode
    depends_on: [TaskService]
    responsibility: Emits a root task with all children when expanded.

  - name: taskEditActionsNotifier
    type: AsyncNotifier<void>
    scope: task_list_edit_mode
    depends_on: [TaskService, TaskHierarchyService, TaskTemplateService]
    responsibility: Handle edit mode intents (edit text, add subtask, archive, drag results).

  - name: focusSessionProvider
    type: StreamProvider.family<FocusSession?, int>
    scope: timer_screen
    depends_on: [FocusFlowService]
    responsibility: Observe active focus session for a task.

  - name: focusActionsNotifier
    type: AsyncNotifier<void>
    scope: timer_screen
    depends_on: [FocusFlowService]
    responsibility: Start/pause/end focus sessions and trigger quick subtasks.

  - name: metricSnapshotProvider
    type: StreamProvider<MetricSnapshot?>
    scope: home_dashboard
    depends_on: [MetricOrchestrator]
    responsibility: Supply latest aggregates for homepage cards.

  - name: metricRefreshNotifier
    type: AsyncNotifier<void>
    scope: home_dashboard
    depends_on: [MetricOrchestrator]
    responsibility: Handle pull-to-refresh requests, invoking recompute.

  - name: preferenceActionsNotifier
    type: AsyncNotifier<void>
    scope: settings
    depends_on: [PreferenceService]
    responsibility: Update locale/theme/font selections.

  - name: templateSuggestionsProvider
    type: FutureProvider.family<List<TaskTemplate>, TemplateSuggestionQuery>
    scope: inbox_input
    depends_on: [TaskTemplateService]
    responsibility: 根据最近使用或输入关键字提供模板候选，最大返回 6 条。

  - name: templateActionsNotifier
    type: AsyncNotifier<void>
    scope: template_management
    depends_on: [TaskTemplateService]
    responsibility: Create/update/delete templates and trigger apply events.

  - name: seedInitializerProvider
    type: FutureProvider<void>
    scope: app_bootstrap
    depends_on: [SeedImportService]
    responsibility: Perform first-run seed import before showing main UI.
