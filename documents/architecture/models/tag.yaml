meta:
  name: "Tag Model"
  type: "model"
  file_path: "lib/data/models/tag.dart"
  description: "标签模型，用于任务分类和过滤"
  version: "1.1"
  created_date: "251025"
  last_updated: "251026"

model_definition:
  name: "Tag"
  storage: "isar_collection"
  immutable: true
  annotation: "@immutable"
  
enums:
  - name: "TagKind"
    values: ["context", "priority", "special"]
    description: "标签类型枚举"
    
fields:
  - name: "id"
    type: "int"
    required: true
    nullable: false
    final: true
    description: "Isar 数据库主键"
    
  - name: "slug"
    type: "String"
    required: true
    nullable: false
    final: true
    description: "标签标识符"
    
  - name: "kind"
    type: "TagKind"
    required: true
    nullable: false
    final: true
    description: "标签类型"
    
  - name: "localizedLabels"
    type: "Map<String, String>"
    required: true
    nullable: false
    final: true
    description: "本地化标签映射"
    
constructors:
  - type: "const"
    name: "Tag"
    parameters:
      - name: "id"
        type: "int"
        required: true
      - name: "slug"
        type: "String"
        required: true
      - name: "kind"
        type: "TagKind"
        required: true
      - name: "localizedLabels"
        type: "Map<String, String>"
        required: true
    description: "主构造函数"
    
methods:
  - name: "labelForLocale"
    return_type: "String"
    parameters:
      - name: "localeCode"
        type: "String"
        required: true
    visibility: "public"
    description: "根据语言代码获取标签文本"
    implementation: "按优先级返回本地化标签：完整语言代码 -> 语言代码 -> 英语 -> slug"
    
imports:
  - "package:flutter/foundation.dart"
  
dependencies:
  - "TagKind"
  
relationships:
  - name: "TagData"
    type: "UI Model"
    description: "UI 展示用的标签数据模型"
    relationship: "one_to_one"
    file_path: "lib/presentation/widgets/tag_data.dart"
    note: "TagData 通过 TagData.fromTag() 方法从 Tag 创建"
  
validation_rules:
  - field: "slug"
    rule: "not_empty"
    description: "标签标识符不能为空"
  - field: "localizedLabels"
    rule: "not_empty"
    description: "本地化标签不能为空"
    
business_rules:
  - name: "locale_fallback"
    description: "标签文本回退机制"
    implementation: "完整语言代码 -> 语言代码 -> 英语 -> slug"
    
storage_config:
  indexes:
    - field: "slug"
    - field: "kind"
  constraints:
    - field: "slug"
      constraint: "unique"

# UI 集成说明
ui_integration:
  description: "Tag 模型与 UI 组件的集成"
  tag_data_conversion:
    method: "TagData.fromTag(tag, locale)"
    description: "将 Tag 模型转换为 TagData 用于 UI 展示"
    parameters:
      - name: "tag"
        type: "Tag"
        description: "源标签模型"
      - name: "locale"
        type: "String"
        description: "目标语言环境"
    returns: "TagData"
    note: "TagData 包含颜色、图标等 UI 特定属性"
  
  modern_tag_usage:
    component: "ModernTag"
    description: "使用 ModernTag 组件展示标签"
    data_source: "TagData"
    variants: ["pill", "dot", "minimal"]
    sizes: ["small", "medium", "large"]
  
  modern_tag_group_usage:
    component: "ModernTagGroup"
    description: "使用 ModernTagGroup 组件管理多个标签"
    data_source: "List<TagData>"
    selection: "支持单选和多选"
    layout: "Wrap 布局，自动换行"