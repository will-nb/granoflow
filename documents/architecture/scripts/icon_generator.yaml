meta:
  name: "Icon Generator Script"
  type: "script"
  file_path: "scripts/icons/generate.py"
  description: "全平台应用图标生成脚本，支持 macOS、iOS、Android 平台"
  version: "2.0"
  created_date: "251026"
  last_updated: "251026"

script_definition:
  name: "icon_generator"
  layer: "build_tools"
  pattern: "utility"
  category: "asset_generation"
  executable: true
  
script_types:
  - name: "Python Script"
    description: "Python 脚本，用于生成应用图标"
    usage: "构建时自动生成、手动生成"
    
script_properties:
  - name: "source_file"
    type: "string"
    required: true
    default_value: "assets/logo/granostack-logo-transparent.png"
    description: "源 Logo 文件路径"
    validation: "文件必须存在"
    
  - name: "background_color"
    type: "tuple"
    required: true
    default_value: "(30, 77, 103)"
    description: "背景色 RGB 值"
    validation: "RGB 三元组"
    
  - name: "output_quality"
    type: "string"
    required: false
    default_value: "LANCZOS"
    description: "图像缩放算法"
    validation: "有效算法名称"
    
script_methods:
  - name: "create_icon_with_background"
    return_type: "bool"
    parameters:
      - name: "source_path"
        type: "string"
        required: true
        description: "源文件路径"
      - name: "output_path"
        type: "string"
        required: true
        description: "输出文件路径"
      - name: "size"
        type: "int"
        required: true
        description: "图标尺寸"
      - name: "background_color"
        type: "tuple"
        required: true
        description: "背景色"
    description: "创建带有背景色的图标"
    visibility: "private"
    async: false
    
  - name: "generate_macos_icons"
    return_type: "bool"
    parameters: []
    description: "生成 macOS 图标"
    visibility: "public"
    async: false
    
  - name: "generate_ios_icons"
    return_type: "bool"
    parameters: []
    description: "生成 iOS 图标"
    visibility: "public"
    async: false
    
  - name: "generate_android_icons"
    return_type: "bool"
    parameters: []
    description: "生成 Android 图标"
    visibility: "public"
    async: false
    
  - name: "main"
    return_type: "void"
    parameters: []
    description: "主函数"
    visibility: "public"
    async: false
    
script_state:
  - name: "theme_color"
    type: "tuple"
    description: "主题色"
    initial_value: "(30, 77, 103)"
    validation: "RGB 三元组"
    
script_lifecycle:
  - phase: "initialization"
    description: "初始化阶段"
    operations: ["检查源文件", "验证目标目录", "设置主题色"]
  - phase: "generation"
    description: "生成阶段"
    operations: ["图像处理", "尺寸缩放", "背景应用", "文件保存"]
  - phase: "cleanup"
    description: "清理阶段"
    operations: ["资源释放", "错误处理"]
    
script_events:
  - name: "on_generation_start"
    description: "生成开始事件"
    trigger: "开始生成图标"
    handler: "日志输出"
    parameters: "平台名称"
    
  - name: "on_generation_complete"
    description: "生成完成事件"
    trigger: "图标生成完成"
    handler: "成功日志"
    parameters: "生成的文件数量"
    
  - name: "on_generation_error"
    description: "生成错误事件"
    trigger: "生成过程中出错"
    handler: "错误处理"
    parameters: "错误信息"
    
script_styling:
  - name: "icon_processing"
    description: "图标处理样式"
    properties:
      - name: "scaling_algorithm"
        type: "string"
        value: "LANCZOS"
        description: "缩放算法"
      - name: "background_fill"
        type: "bool"
        value: "true"
        description: "填充背景"
      - name: "logo_centering"
        type: "bool"
        value: "true"
        description: "Logo 居中"
    responsive: false
    theme_aware: true
    
script_responsive:
  - breakpoint: "macos"
    description: "macOS 图标生成"
    properties:
      - name: "icon_sizes"
        value: "[16, 32, 64, 128, 256, 512, 1024]"
        description: "macOS 图标尺寸"
    layout: "正方形画布"
    behavior: "系统自动圆角裁剪"
    
  - breakpoint: "ios"
    description: "iOS 图标生成"
    properties:
      - name: "icon_sizes"
        value: "[20, 29, 40, 60, 76, 83.5, 1024]"
        description: "iOS 图标尺寸"
    layout: "正方形画布"
    behavior: "系统自动圆角裁剪"
    
  - breakpoint: "android"
    description: "Android 图标生成"
    properties:
      - name: "icon_sizes"
        value: "[48, 72, 96, 144, 192]"
        description: "Android 图标尺寸"
    layout: "正方形画布"
    behavior: "直接显示"
    
script_accessibility:
  - name: "error_handling"
    description: "错误处理"
    implementation: "完整的错误处理和日志记录"
    testing: "错误场景测试"
    compliance: "脚本可靠性"
    
  - name: "progress_feedback"
    description: "进度反馈"
    implementation: "生成进度日志"
    testing: "进度测试"
    compliance: "用户体验"
    
script_performance:
  - operation: "image_processing"
    optimization: "图像处理优化"
    description: "图像处理性能优化"
    caching: "无缓存"
    rendering: "高质量渲染"
    
script_testing:
  - name: "test_icon_generation"
    description: "测试图标生成"
    type: "integration"
    coverage: "100%"
    scenarios: "所有平台、所有尺寸、错误处理"
    
script_dependencies:
  - name: "PIL"
    type: "Python库"
    description: "Python Imaging Library"
    required: true
    version: "最新版本"
    
script_imports:
  - "import os"
  - "from PIL import Image"
  
script_categories:
  build_tools:
    - name: "icon_generator"
      description: "图标生成脚本"
      type: "Python Script"
      category: "asset_generation"
      
script_interactions:
  - name: "file_operations"
    description: "文件操作交互"
    type: "io"
    handler: "文件读写处理"
    feedback: "进度日志"
    accessibility: "支持错误处理"
    
script_animations:
  - name: "progress_indicator"
    description: "进度指示器"
    type: "text"
    duration: "实时"
    curve: "线性"
    trigger: "生成进度"
    
script_validation:
  - field: "source_file"
    rule: "file_exists"
    description: "源文件必须存在"
    message: "源文件不存在"
    required: true
    
  - field: "background_color"
    rule: "valid_rgb"
    description: "背景色必须是有效的RGB值"
    message: "背景色必须是有效的RGB值"
    required: true
    
script_error_handling:
  - exception: "FileNotFoundError"
    description: "文件未找到异常"
    handling: "检查文件路径并提示用户"
    recovery: "使用默认路径或退出"
    user_feedback: "显示错误信息"
    
  - exception: "ImageProcessingError"
    description: "图像处理异常"
    handling: "记录错误并继续处理其他文件"
    recovery: "跳过当前文件"
    user_feedback: "显示处理错误"
    
script_internationalization:
  - name: "script_messages"
    description: "脚本消息国际化"
    languages: "zh_CN, en_US"
    fallback: "en_US"
    context: "脚本输出消息"
    
script_theme_integration:
  - name: "color_scheme"
    description: "颜色方案"
    type: "theme"
    default_value: "Navy Blue (#1E4D67)"
    theme_aware: true
    
script_state_management:
  - pattern: "无状态管理"
    description: "通过参数管理状态"
    implementation: "使用函数参数"
    benefits: "简单、高效"
    considerations: "无状态变化"
    
script_testing_strategy:
  unit_tests:
    - name: "test_icon_creation"
      description: "测试图标创建"
    - name: "test_color_application"
      description: "测试颜色应用"
    - name: "test_size_scaling"
      description: "测试尺寸缩放"
    - name: "test_file_operations"
      description: "测试文件操作"
      
  integration_tests:
    - name: "test_platform_generation"
      description: "测试平台生成"
    - name: "test_error_handling"
      description: "测试错误处理"
    - name: "test_performance"
      description: "测试性能"
    - name: "test_output_quality"
      description: "测试输出质量"
      
  mock_strategy:
    - name: "MockImage"
      description: "Mock 图像处理"
    - name: "FakeFileSystem"
      description: "Fake 文件系统"
    - name: "TestIconGenerator"
      description: "测试专用生成器"
