meta:
  name: "ANZ Command Script"
  type: "script"
  file_path: "scripts/anz"
  description: "GranoFlow 项目管理脚本，提供项目清理、构建和图标生成功能"
  version: "2.0"
  created_date: "251026"
  last_updated: "251026"

script_definition:
  name: "anz"
  layer: "build_tools"
  pattern: "command_line"
  category: "project_management"
  executable: true
  
script_types:
  - name: "Bash Script"
    description: "Bash 脚本，用于项目管理"
    usage: "命令行工具、CI/CD 集成"
    
script_properties:
  - name: "command"
    type: "string"
    required: true
    default_value: "help"
    description: "执行的命令"
    validation: "有效命令名称"
    
  - name: "timeout"
    type: "int"
    required: false
    default_value: "120"
    description: "命令超时时间（秒）"
    validation: "正整数"
    
script_methods:
  - name: "clean_project"
    return_type: "void"
    parameters: []
    description: "清理项目并重建"
    visibility: "public"
    async: false
    
  - name: "build_aab"
    return_type: "void"
    parameters: []
    description: "构建 Android App Bundle"
    visibility: "public"
    async: false
    
  - name: "generate_icons_all"
    return_type: "void"
    parameters: []
    description: "生成所有平台图标"
    visibility: "public"
    async: false
    
  - name: "show_help"
    return_type: "void"
    parameters: []
    description: "显示帮助信息"
    visibility: "public"
    async: false
    
script_state:
  - name: "GREEN"
    type: "string"
    description: "绿色输出颜色"
    initial_value: "\\033[0;32m"
    validation: "ANSI 颜色代码"
    
  - name: "RED"
    type: "string"
    description: "红色输出颜色"
    initial_value: "\\033[0;31m"
    validation: "ANSI 颜色代码"
    
  - name: "BLUE"
    type: "string"
    description: "蓝色输出颜色"
    initial_value: "\\033[0;34m"
    validation: "ANSI 颜色代码"
    
  - name: "YELLOW"
    type: "string"
    description: "黄色输出颜色"
    initial_value: "\\033[0;33m"
    validation: "ANSI 颜色代码"
    
  - name: "NC"
    type: "string"
    description: "无颜色"
    initial_value: "\\033[0m"
    validation: "ANSI 重置代码"
    
script_lifecycle:
  - phase: "initialization"
    description: "初始化阶段"
    operations: ["设置颜色变量", "解析命令行参数"]
  - phase: "execution"
    description: "执行阶段"
    operations: ["执行命令", "处理输出", "错误处理"]
  - phase: "cleanup"
    description: "清理阶段"
    operations: ["资源释放", "状态重置"]
    
script_events:
  - name: "on_command_start"
    description: "命令开始事件"
    trigger: "开始执行命令"
    handler: "日志输出"
    parameters: "命令名称"
    
  - name: "on_command_complete"
    description: "命令完成事件"
    trigger: "命令执行完成"
    handler: "成功日志"
    parameters: "执行结果"
    
  - name: "on_command_error"
    description: "命令错误事件"
    trigger: "命令执行出错"
    handler: "错误处理"
    parameters: "错误信息"
    
script_styling:
  - name: "output_formatting"
    description: "输出格式化"
    properties:
      - name: "color_enabled"
        type: "bool"
        value: "true"
        description: "启用颜色输出"
      - name: "emoji_enabled"
        type: "bool"
        value: "true"
        description: "启用表情符号"
      - name: "progress_indicator"
        type: "bool"
        value: "true"
        description: "进度指示器"
    responsive: false
    theme_aware: false
    
script_responsive:
  - breakpoint: "clean"
    description: "清理命令"
    properties:
      - name: "operations"
        value: "[\"清空数据库\", \"flutter clean\", \"删除构建文件夹\", \"gen-l10n\", \"pub get\", \"analyze\"]"
        description: "清理操作列表"
    layout: "顺序执行"
    behavior: "完整清理和重建"
    
  - breakpoint: "build:aab"
    description: "构建 AAB 命令"
    properties:
      - name: "build_type"
        value: "release"
        description: "构建类型"
    layout: "构建流程"
    behavior: "生成 AAB 文件"
    
  - breakpoint: "icons:generate"
    description: "图标生成命令"
    properties:
      - name: "platforms"
        value: "[\"macOS\", \"iOS\", \"Android\"]"
        description: "支持平台"
    layout: "并行生成"
    behavior: "生成所有平台图标"
    
script_accessibility:
  - name: "error_handling"
    description: "错误处理"
    implementation: "完整的错误处理和用户反馈"
    testing: "错误场景测试"
    compliance: "脚本可靠性"
    
  - name: "progress_feedback"
    description: "进度反馈"
    implementation: "实时进度显示"
    testing: "进度测试"
    compliance: "用户体验"
    
script_performance:
  - operation: "command_execution"
    optimization: "命令执行优化"
    description: "命令执行性能优化"
    caching: "无缓存"
    rendering: "实时输出"
    
script_testing:
  - name: "test_command_execution"
    description: "测试命令执行"
    type: "integration"
    coverage: "100%"
    scenarios: "所有命令、错误处理、超时处理"
    
script_dependencies:
  - name: "flutter"
    type: "命令行工具"
    description: "Flutter SDK"
    required: true
    version: "最新版本"
    
  - name: "python3"
    type: "运行时"
    description: "Python 3 运行时"
    required: true
    version: "3.x"
    
script_imports:
  - "#!/bin/bash"
  
script_categories:
  build_tools:
    - name: "anz"
      description: "项目管理脚本"
      type: "Bash Script"
      category: "project_management"
      
script_interactions:
  - name: "command_execution"
    description: "命令执行交互"
    type: "process"
    handler: "命令执行处理"
    feedback: "实时输出"
    accessibility: "支持错误处理"
    
script_animations:
  - name: "progress_spinner"
    description: "进度旋转器"
    type: "text"
    duration: "实时"
    curve: "循环"
    trigger: "长时间操作"
    
script_validation:
  - field: "command"
    rule: "valid_command"
    description: "命令必须是有效的"
    message: "未知命令"
    required: true
    
  - field: "timeout"
    rule: "positive_integer"
    description: "超时时间必须是正整数"
    message: "超时时间必须是正整数"
    required: false
    
script_error_handling:
  - exception: "CommandNotFoundError"
    description: "命令未找到异常"
    handling: "检查命令是否存在并提示用户"
    recovery: "显示帮助信息"
    user_feedback: "显示可用命令"
    
  - exception: "TimeoutError"
    description: "超时异常"
    handling: "记录超时并终止命令"
    recovery: "返回错误状态"
    user_feedback: "显示超时信息"
    
script_internationalization:
  - name: "script_messages"
    description: "脚本消息国际化"
    languages: "zh_CN, en_US"
    fallback: "en_US"
    context: "脚本输出消息"
    
script_theme_integration:
  - name: "color_scheme"
    description: "颜色方案"
    type: "terminal"
    default_value: "ANSI 颜色"
    theme_aware: false
    
script_state_management:
  - pattern: "无状态管理"
    description: "通过参数管理状态"
    implementation: "使用命令行参数"
    benefits: "简单、高效"
    considerations: "无状态变化"
    
script_testing_strategy:
  unit_tests:
    - name: "test_command_parsing"
      description: "测试命令解析"
    - name: "test_help_display"
      description: "测试帮助显示"
    - name: "test_error_handling"
      description: "测试错误处理"
    - name: "test_timeout_handling"
      description: "测试超时处理"
      
  integration_tests:
    - name: "test_clean_command"
      description: "测试清理命令"
    - name: "test_build_command"
      description: "测试构建命令"
    - name: "test_icons_command"
      description: "测试图标命令"
    - name: "test_full_workflow"
      description: "测试完整工作流"
      
  mock_strategy:
    - name: "MockFlutter"
      description: "Mock Flutter 命令"
    - name: "FakeFileSystem"
      description: "Fake 文件系统"
    - name: "TestAnzCommand"
      description: "测试专用命令"
